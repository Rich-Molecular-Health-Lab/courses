---
title: "Schedule Management"
format: html
params:
  course: "conbio_25f"
---

```{r setup, include = FALSE}

here::i_am("schedules/schedule_management.qmd")
source(here::here("_common.R"))
library(reactable)
library(reactablefmtr)
library(tippy)
source(here("helpers/course_list.R"))
source(here("helpers/agenda_helpers.R"))

semester     <- str_extract(params$course, "(?<=_)\\d{2}\\w")
course_short <- str_extract(params$course, "\\w+(?=_)")

```

```{r}
#| context: data
#| 
source(here("helpers/semesters.R"))
source(here(paste0(semester, "/", course_short, "/topics.R")))
source(here(paste0(semester, "/", course_short, "/schedule_detail.R")))
source(here("schedules/schedule_reactable.R"))
blank_schedule <- semester_days(params$course)
```

```{r}
topics_revised <- revise_topics(topics, discarded)
topics_flat    <- flatten_topics(topics_revised)

schedule_draft <- map_topics(topics_flat, topics_nested, blank_schedule)
schedule <- enframe_schedule(schedule_draft, assignments, locations, params$course)


```

```{r}
save(schedule, file = here(
  paste0(semester, "/", course_short, "/schedule.RData")
  ))
```
